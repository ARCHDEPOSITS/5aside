let cardList = [];
let editIndex = -1;

document.addEventListener('DOMContentLoaded', () => {
    loadCards();
});

function toggleForm() {
    const form = document.getElementById('cardForm');
    form.style.display = form.style.display === 'block' ? 'none' : 'block';
}

function addCard() {
    const name = document.getElementById('cardName').value;
    const details = document.getElementById('cardDetails').value;
    const wins = parseInt(document.getElementById('cardWins').value) || 0;
    const losses = parseInt(document.getElementById('cardLosses').value) || 0;
    const ties = parseInt(document.getElementById('cardTies').value) || 0;
    const ballonDior = document.getElementById('cardBallonDior').value;

    if (name && details) {
        if (editIndex === -1) {
            cardList.push({ name, details, wins, losses, ties, ballonDior });
        } else {
            cardList[editIndex] = { name, details, wins, losses, ties, ballonDior };
            editIndex = -1;
        }
        saveCards();
        clearForm();
        displayCards();
        toggleForm();
    } else {
        alert('Please enter both name and details.');
    }
}

function editCard(index) {
    const card = cardList[index];
    document.getElementById('cardName').value = card.name;
    document.getElementById('cardDetails').value = card.details;
    document.getElementById('cardWins').value = card.wins;
    document.getElementById('cardLosses').value = card.losses;
    document.getElementById('cardTies').value = card.ties;
    document.getElementById('cardBallonDior').value = card.ballonDior;
    editIndex = index;
    toggleForm();
}

function searchCards() {
    const searchQuery = document.getElementById('searchInput').value.toLowerCase();
    const filteredCards = cardList.filter(card => 
        card.name.toLowerCase().includes(searchQuery) || 
        card.details.toLowerCase().includes(searchQuery) ||
        card.ballonDior.toLowerCase().includes(searchQuery)
    );
    displayCards(filteredCards);
}

function displayCards(cards = cardList) {
    const cardListElement = document.getElementById('cardList');
    cardListElement.innerHTML = '';

    if (cards.length === 0) {
        cardListElement.innerHTML = '<p>No cards found.</p>';
        return;
    }

    cards.forEach((card, index) => {
        const cardItem = document.createElement('div');
        cardItem.classList.add('card-item');
        cardItem.innerHTML = `
            <strong>${card.name}</strong>
            <p>${card.details}</p>
            <p><strong>Wins:</strong> ${card.wins}</p>
            <p><strong>Losses:</strong> ${card.losses}</p>
            <p><strong>Ties:</strong> ${card.ties}</p>
            <p><strong>Ballon Dior:</strong> ${card.ballonDior}</p>
            <button class="edit-button" onclick="editCard(${index})">Edit</button>
        `;
        cardListElement.appendChild(cardItem);
    });
}

function clearForm() {
    document.getElementById('cardName').value = '';
    document.getElementById('cardDetails').value = '';
    document.getElementById('cardWins').value = '';
    document.getElementById('cardLosses').value = '';
    document.getElementById('cardTies').value = '';
    document.getElementById('cardBallonDior').value = '';
}

function saveCards() {
    localStorage.setItem('cardList', JSON.stringify(cardList));
}

function loadCards() {
    const savedCards = localStorage.getItem('cardList');
    if (savedCards) {
        cardList = JSON.parse(savedCards);
        displayCards();
    }
}
